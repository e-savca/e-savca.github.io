<!DOCTYPE html> <html><head>
		<title>LINQ by Metanit</title>
		<base href="../../">
		<meta id="root-path" root-path="../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="EUGENIU2 - LINQ by Metanit">
		<meta property="og:title" content="LINQ by Metanit">
		<meta property="og:description" content="EUGENIU2 - LINQ by Metanit">
		<meta property="og:type" content="website">
		<meta property="og:url" content="04.-literature-notes/linq-by-metanit/linq-by-metanit.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="EUGENIU2">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager native-scrollbars theme-light show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> Literature<span class="token punctuation">-</span>Note
  <span class="token punctuation">-</span> IT/Linq
  <span class="token punctuation">-</span> IT/Guides
  <span class="token punctuation">-</span> IT/DotNet
  <span class="token punctuation">-</span> IT/Sources/Metanit</code><button class="copy-code-button">Copy</button></pre><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="LINQ by Metanit"><p>LINQ by Metanit</p></h1><div class="heading-wrapper"><h3 data-heading="Основы LINQ" class="heading" id="Основы_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Основы LINQ</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Основы LINQ" src="Основы LINQ" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Основы LINQ</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 3846px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>LINQ&nbsp;(Language-Integrated Query) представляет простой и удобный язык запросов к источнику данных. В качестве источника данных может выступать объект, реализующий интерфейс IEnumerable (например, стандартные коллекции, массивы), набор данных DataSet, документ XML. Но вне зависимости от типа источника LINQ позволяет применить ко всем один и тот же подход для выборки данных.</p></div><div><p>Существует несколько разновидностей LINQ:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>LINQ to Objects: применяется для работы с массивами и коллекциями</li>
<li data-line="1"><div class="list-bullet"></div>LINQ to Entities: используется при обращении к базам данных через технологию Entity Framework</li>
<li data-line="2"><div class="list-bullet"></div>LINQ to XML: применяется при работе с файлами XML</li>
<li data-line="3"><div class="list-bullet"></div>LINQ to DataSet: применяется при работе с объектом DataSet</li>
<li data-line="4"><div class="list-bullet"></div>Parallel LINQ (PLINQ): используется для выполнения параллельных запросов</li>
</ul></div><div><p>В этой главе речь пойдет прежде всего о&nbsp;LINQ to Objects, но в последующих материалах также будут затронуты и другие разновидности LINQ. Основная часть функциональности LINQ сосредоточена в пространстве имен&nbsp;System.LINQ. В проектах под .NET 6 данное пространство имен подключается по умолчанию.</p></div><div><p>В чем же удобство LINQ? Посмотрим на простейшем примере. Выберем из массива строки, которые начинаются на определенную букву, например, букву “T”, и отсортируем полученный список:</p></div><div><pre class="language-none" tabindex="0"><code class="language-C# language-none is-loaded">string[] people = { "Tom", "Bob", "Sam", "Tim", "Tomas", "Bill" };

// Creăm un nou List pentru rezultate
var selectedPeople = new List&lt;string&gt;();

// Parcurgem array-ul
foreach (string person in people)
{
    // Dacă string-ul începe cu litera 'T', îl adăugăm în List
    if (person.ToUpper().StartsWith("T"))
        selectedPeople.Add(person);
}

// Sortăm List-ul
selectedPeople.Sort();

foreach (string person in selectedPeople)
    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Для отфильтрованных строк создается специальный список. Затем в цикле проходим по всем элементам массива и, если они соответствуют условию (начинаются на букву T), то добавляем их в этот список. Затем сортируем список по возрастанию. И в конце элементы полученного списка выводим на консоль:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tim
Tom
Tomas
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Хотя подобный подход вполне работает, однако LINQ позволяет значительно сократить код с помощью интуитивно понятного и краткого синтаксиса.</p></div><div><p>Для работы с колекциями можно использовать два способа:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>Операторы запросов LINQ</li>
<li data-line="1"><div class="list-bullet"></div>Методы расширений LINQ</li>
</ul></div><div><p>Рассмотрим оба способа</p></div><div class="heading-wrapper"><h3 data-heading="Операторы запросов LINQ" class="heading" id="Операторы_запросов_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Операторы запросов LINQ</h3><div class="heading-children"><div><p>Операторы запросов LINQ в каком-то роде частично напоминают синтаксис запросов SQL, поэтому если вы работали когда-нибудь с sql-запросами, то будет проще понять общую концепцию. Итак, изменим предыдущий пример, применив операторы запросов LINQ:</p></div><div><pre class="language-none" tabindex="0"><code class="language-C# language-none is-loaded">string[] people = { "Tom", "Bob", "Sam", "Tim", "Tomas", "Bill" };

// Создаем новый список для результатов
var selectedPeople = from p in people  // Передаем каждый элемент из people в переменную p
                    where p.ToUpper().StartsWith("T") // Фильтрация по критерию
                    orderby p  // Упорядочиваем по возрастанию
                    select p; // Выбираем объекты в создаваемую коллекцию

foreach (string person in selectedPeople)
    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Прежде всего, как мы видим, код стал меньше и проще, а результат будет тем же. В принципе все выражение можно было бы записать в одну строку:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people <span class="token keyword">where</span> <span class="token class-name">p</span><span class="token punctuation">.</span><span class="token function">ToUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token string">"T"</span><span class="token punctuation">)</span> <span class="token keyword">orderby</span> p  <span class="token keyword">select</span> p<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Но для более понятной логической разбивки я поместил каждое отдельное подвыражение на отдельной строке.</p></div><div><p>Простейшее определение запроса LINQ выглядит следующим образом:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">from переменная <span class="token keyword">in</span> набор_объектов <span class="token keyword">select</span> переменная<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Итак, что делает этот запрос LINQ? Выражение&nbsp;<code>from p in people</code>&nbsp;проходит по всем элементам массива people и определяет каждый элемент как&nbsp;<code>p</code>. Используя переменную&nbsp;<code>p</code>&nbsp;мы можем проводить над ней разные операции.</p></div><div><p>Несмотря на то, что мы не указываем тип переменной&nbsp;<code>p</code>, выражения LINQ являются строго типизированными. То есть среда автоматически распознает, что набор people состоит из объектов string, поэтому переменная&nbsp;<code>p</code>&nbsp;будет рассматриваться в качестве строки.</p></div><div><p>Далее с помощью оператора&nbsp;<code>where</code>&nbsp;проводится фильтрация объектов, и если объект соответствует критерию (в данном случае начальная буква должна быть “T”), то этот объект передается дальше.</p></div><div><p>Оператор&nbsp;<code>orderby</code>&nbsp;упорядочивает по возрастанию, то есть сортирует выбранные объекты.</p></div><div><p>Оператор&nbsp;<code>select</code>&nbsp;передает выбранные значения в результирующую выборку, которая возвращается LINQ-выражением.</p></div><div><p>В данном случае результатом выражения LINQ является объект&nbsp;<code>IEnumerable&lt;T&gt;</code>. Нередко результирующая выборка определяется с помощью ключевого слова&nbsp;<code>var</code>, тогда компилятор на этапе компиляции сам выводит тип.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Методы расширения LINQ" class="heading" id="Методы_расширения_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Методы расширения LINQ</h3><div class="heading-children"><div><p>Кроме стандартного синтаксиса&nbsp;<code>from .. in .. select</code>&nbsp;для создания запроса LINQ мы можем применять специальные методы расширения, которые определены для интерфейса&nbsp;<code>IEnumerable</code>. Как правило, эти методы реализуют ту же функциональность, что и операторы LINQ типа&nbsp;<code>where</code>&nbsp;или&nbsp;<code>orderby</code>.</p></div><div><p>Например:</p></div><div><pre class="language-none" tabindex="0"><code class="language-C# language-none is-loaded">string[] people = { "Tom", "Bob", "Sam", "Tim", "Tomas", "Bill" };
var selectedPeople = people.Where(p =&gt; p.ToUpper().StartsWith("T")).OrderBy(p =&gt; p);

foreach (string person in selectedPeople)
    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Запрос&nbsp;<code>people.Where(p=&gt;p.ToUpper().StartsWith("T")).OrderBy(p =&gt; p)</code>&nbsp;будет аналогичен предыдущему. Он состоит из цепочки методов Where и OrderBy. В качестве аргумента эти методы принимают делегат или лямбда-выражение.</p></div><div><p>И хотя ряд действий мы можем реализовать как с помощью операторов запросов LINQ, так и с помощью методов расширений LINQ, но не каждый метод расширения имеет аналог среди операторов LINQ. И в этом случае можно сочетать оба подхода. Например, используем стандартный синтаксис linq и метод расширения Count(), который возвращает количество элементов в выборке:</p></div><div><pre class="language-none" tabindex="0"><code class="language-C# language-none is-loaded">int number = (from p in people where p.ToUpper().StartsWith("T") select p).Count();
Console.WriteLine(number); // 3
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Список используемых методов расширения LINQ" class="heading" id="Список_используемых_методов_расширения_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Список используемых методов расширения LINQ</h3><div class="heading-children"><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>Select: определяет проекцию выбранных значений</li>
<li data-line="1"><div class="list-bullet"></div>Where: определяет фильтр выборки</li>
<li data-line="2"><div class="list-bullet"></div>OrderBy: упорядочивает элементы по возрастанию</li>
<li data-line="3"><div class="list-bullet"></div>OrderByDescending: упорядочивает элементы по убыванию</li>
<li data-line="4"><div class="list-bullet"></div>ThenBy: задает дополнительные критерии для упорядочивания элементов возрастанию</li>
<li data-line="5"><div class="list-bullet"></div>ThenByDescending: задает дополнительные критерии для упорядочивания элементов по убыванию</li>
<li data-line="6"><div class="list-bullet"></div>Join: соединяет две коллекции по определенному признаку</li>
<li data-line="7"><div class="list-bullet"></div>Aggregate: применяет к элементам последовательности агрегатную функцию, которая сводит их к одному объекту</li>
<li data-line="8"><div class="list-bullet"></div>GroupBy: группирует элементы по ключу</li>
<li data-line="9"><div class="list-bullet"></div>ToLookup: группирует элементы по ключу, при этом все элементы добавляются в словарь</li>
<li data-line="10"><div class="list-bullet"></div>GroupJoin: выполняет одновременно <a data-href="Соединение коллекций" href="04.-literature-notes/linq-by-metanit/соединение-коллекций.html" class="internal-link" target="_self" rel="noopener">Соединение коллекций</a> и группировку элементов по ключу</li>
<li data-line="11"><div class="list-bullet"></div>Reverse: располагает элементы в обратном порядке</li>
<li data-line="12"><div class="list-bullet"></div>All: определяет, все ли элементы коллекции удовлятворяют определенному условию</li>
<li data-line="13"><div class="list-bullet"></div>Any: определяет, удовлетворяет хотя бы один элемент коллекции определенному условию</li>
<li data-line="14"><div class="list-bullet"></div>Contains: определяет, содержит ли коллекция определенный элемент</li>
<li data-line="15"><div class="list-bullet"></div>Distinct: удаляет дублирующиеся элементы из коллекции</li>
<li data-line="16"><div class="list-bullet"></div>Except: возвращает разность двух коллекцию, то есть те элементы, которые создаются только в одной коллекции</li>
<li data-line="17"><div class="list-bullet"></div>Union: объединяет две однородные коллекции</li>
<li data-line="18"><div class="list-bullet"></div>Intersect: возвращает пересечение двух коллекций, то есть те элементы, которые встречаются в обоих коллекциях</li>
<li data-line="19"><div class="list-bullet"></div>Count: подсчитывает количество элементов коллекции, которые удовлетворяют определенному условию</li>
<li data-line="20"><div class="list-bullet"></div>Sum: подсчитывает сумму числовых значений в коллекции</li>
<li data-line="21"><div class="list-bullet"></div>Average: подсчитывает cреднее значение числовых значений в коллекции</li>
<li data-line="22"><div class="list-bullet"></div>Min: находит минимальное значение</li>
<li data-line="23"><div class="list-bullet"></div>Max: находит максимальное значение</li>
<li data-line="24"><div class="list-bullet"></div>Take: выбирает определенное количество элементов</li>
<li data-line="25"><div class="list-bullet"></div>Skip: пропускает определенное количество элементов</li>
<li data-line="26"><div class="list-bullet"></div>TakeWhile: возвращает цепочку элементов последовательности, до тех пор, пока условие истинно</li>
<li data-line="27"><div class="list-bullet"></div>SkipWhile: пропускает элементы в последовательности, пока они удовлетворяют заданному условию, и затем возвращает оставшиеся элементы</li>
<li data-line="28"><div class="list-bullet"></div>Concat: объединяет две коллекции</li>
<li data-line="29"><div class="list-bullet"></div>Zip: объединяет две коллекции в соответствии с определенным условием</li>
<li data-line="30"><div class="list-bullet"></div>First: выбирает первый элемент коллекции</li>
<li data-line="31"><div class="list-bullet"></div>FirstOrDefault: выбирает первый элемент коллекции или возвращает значение по умолчанию</li>
<li data-line="32"><div class="list-bullet"></div>Single: выбирает единственный элемент коллекции, если коллекция содержит больше или меньше одного элемента, то генерируется исключение</li>
<li data-line="33"><div class="list-bullet"></div>SingleOrDefault: выбирает единственный элемент коллекции. Если коллекция пуста, возвращает значение по умолчанию. Если в коллекции больше одного элемента, генерирует исключение</li>
<li data-line="34"><div class="list-bullet"></div>ElementAt: выбирает элемент последовательности по определенному индексу</li>
<li data-line="35"><div class="list-bullet"></div>ElementAtOrDefault: выбирает элемент коллекции по определенному индексу или возвращает значение по умолчанию, если индекс вне допустимого диапазона</li>
<li data-line="36"><div class="list-bullet"></div>Last: выбирает последний элемент коллекции</li>
<li data-line="37"><div class="list-bullet"></div>LastOrDefault: выбирает последний элемент коллекции или возвращает значение по умолчанию</li>
</ul></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Проекция данных" class="heading" id="Проекция_данных"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Проекция данных</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Проекция данных" src="Проекция данных" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Проекция данных</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 3874px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Проекция данных</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Проекция позволяет преобразовать объект одного типа в объект другого типа. Для проекции используется оператор&nbsp;<strong>select</strong>. Допустим, у нас есть набор объектов следующего класса, представляющего пользователя:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Но, допустим, нам нужен не весь объект, а только его свойство Name:</p></div><div><pre class="language-none" tabindex="0"><code class="language-C# language-none is-loaded">var people = new List&lt;Person&gt; {
    new Person ("Tom", 23),
    new Person ("Bob", 27),
    new Person ("Sam", 29),
    new Person ("Alice", 24)
};

var names = from p in people select p.Name;

foreach (string n in names)
    Console.WriteLine(n);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результат выражения LINQ будет представлять набор строк, поскольку выражение&nbsp;<code>select p.Name</code>&nbsp;выбирает в результирующую выборку только значения свойства Name.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom
Bob
Sam
Alice
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В качестве альтернативы мы могли бы использовать метод расширения&nbsp;Select():</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token function">Select</span><span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TResult<span class="token punctuation">&gt;</span></span> selector<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Этот метод принимает функцию преобразования в виде делегата Func&lt;TSource,TResult&gt;. Функция преобразования получает каждый объект выборки типа TSource и с его помощью создает объект TResult. Метод Select возвращает коллекцию преобразованных объектов.</p></div><div><p>Перепишем предыдущий пример с применением метода Select:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
	<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    
	<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    
	<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    
	<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> names <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>u <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> n <span class="token keyword">in</span> names<span class="token punctuation">)</span>
	Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогично можно создать объекты другого типа, в том числе анонимного:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> personel <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people            <span class="token keyword">select</span> <span class="token keyword">new</span>            <span class="token punctuation">{</span>                FirstName <span class="token operator">=</span> p<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>                Year <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Year <span class="token operator">-</span> p<span class="token punctuation">.</span>Age            <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> p <span class="token keyword">in</span> personel<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">p<span class="token punctuation">.</span>FirstName</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">p<span class="token punctuation">.</span>Year</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь оператор&nbsp;<code>select</code>&nbsp;создает объект анонимного типа, используя текущий объект Person. И теперь результат будет содержать набор объектов данного анонимного типа, в котором определены два свойства: FirstName и Year (год рождения). Консольный вывод программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom <span class="token operator">-</span> <span class="token number">1999</span>
Bob <span class="token operator">-</span> <span class="token number">1995</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В качестве альтернативы мы могли бы использовать метод расширения&nbsp;Select():</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token comment">// проекция на объекты анонимного типаvar personel = people.Select(p =&gt; new{    FirstName = p.Name,    Year = DateTime.Now.Year - p.Age});</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="heading-wrapper"><h3 data-heading="Переменые в запросах и оператор let" class="heading" id="Переменые_в_запросах_и_оператор_let"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Переменые в запросах и оператор let</h3><div class="heading-children"><div><p>Иногда возникает необходимость произвести в запросах LINQ какие-то дополнительные промежуточные вычисления. Для этих целей мы можем задать в запросах свои переменные с помощью оператора&nbsp;let:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> personnel <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people               <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"Mr. </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">p<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>               <span class="token keyword">let</span> year <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Year <span class="token operator">-</span> p<span class="token punctuation">.</span>Age               <span class="token keyword">select</span> <span class="token keyword">new</span>            <span class="token punctuation">{</span>                Name <span class="token operator">=</span> name<span class="token punctuation">,</span>                Year <span class="token operator">=</span> year            <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> p <span class="token keyword">in</span> personnel<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">p<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">p<span class="token punctuation">.</span>Year</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае создаются две переменных. Переменная&nbsp;<code>name</code>, значение которой равно&nbsp;<code>$"Mr. {p.Name}"</code>.</p></div><div><p>Возможность определения переменных наверное одно из главных преимуществ операторов LINQ по сравнению с методами расширения.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Выборка из нескольких источников" class="heading" id="Выборка_из_нескольких_источников"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Выборка из нескольких источников</h3><div class="heading-children"><div><p>В LINQ можно выбирать объекты не только из одного, но и из большего количества источников. Например, возьмем классы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Course</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Title<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// учебный курсrecord class Student(string Name);  // студент</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Класс Course представляет учебный курс и хранит его название. Класс Student представляет студента и хранит его имя.</p></div><div><p>Допустим, нам надо из списка курсов и списка студентов получить набор пар студент-курс (условно говоря сущность, которая представляет учебу студента на данном курсе):</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> courses <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Course<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Course</span><span class="token punctuation">(</span><span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Course</span><span class="token punctuation">(</span><span class="token string">"Java"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> enrollments <span class="token operator">=</span> <span class="token keyword">from</span> course <span class="token keyword">in</span> courses    <span class="token comment">//  выбираем по одному курсу             from student in students       //  выбираем по одному студенту             select new { Student = student.Name, Course = course.Title};   // соединяем каждого студента с каждым курсомforeach (var enrollment in enrollments)    Console.WriteLine($"{enrollment.Student} - {enrollment.Course}");record class Course(string Title);  // учебный курсrecord class Student(string Name);  // студент</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom <span class="token operator">-</span> C#
Bob <span class="token operator">-</span> C#
Tom <span class="token operator">-</span> Java
Bob <span class="token operator">-</span> Java
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Таким образом, при выборке из двух источников каждый элемент из первого источника будет сопоставляться с каждым элементом из второго источника. То есть получиться 4 пары.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="SelectMany и сведение объектов" class="heading" id="SelectMany_и_сведение_объектов"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>SelectMany и сведение объектов</h3><div class="heading-children"><div><p>Метод&nbsp;SelectMany&nbsp;позволяет свести набор коллекций в одну коллекцию. Он имеет ряд перегруженных версий. Возьмем одну из них:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token function">SelectMany</span><span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>TResult<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> selector<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">SelectMany</span><span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>TCollection<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> collectionSelector<span class="token punctuation">,</span>           <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TCollection<span class="token punctuation">,</span>TResult<span class="token punctuation">&gt;</span></span> resultSelector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Первая версия метода принимает функцию преобразования в виде делегата&nbsp;<code>Func&lt;TSource,IEnumerable&lt;TResult&gt;&gt;</code>. Функция преобразования получает каждый объект выборки типа TSource и с его помощью создает набор объектов TResult. Метод SelectMany возвращает коллекцию преобразованных объектов.</p></div><div><p>Вторая версия принимает функцию преобразования в виде делегата&nbsp;<code>Func&lt;TSource,IEnumerable&lt;TResult&gt;&gt;</code>. Функция преобразования получает каждый объект выборки типа TSource и возвращает некоторую промежуточную коллекцию типа TCollection. Второй параметр - то же функция функция преобразования в виде делегата&nbsp;<code>Func&lt;TSource,TCollection,TResult&gt;</code>, которая получает два параметра - каждый элемент текущей выборки и каждый элемент промежуточной коллекции и на их основе создает некоторый объект типа TResult.</p></div><div><p>Рассмотрим следующий пример:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Company<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> companies<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Staff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> emp <span class="token keyword">in</span> employees<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> Staff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь нам дан список компаний, в каждой компании имеет набор сотрудников в виде списка объектов Person. И на выходе мы получаем список сотрудников всех компаний, то есть по сути коллекцию объектов Person. Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom
Bob
Sam
Mike
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогичный пример с помощью операторов LINQ:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Company<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> <span class="token keyword">from</span> c <span class="token keyword">in</span> companies                <span class="token keyword">from</span> emp <span class="token keyword">in</span> c<span class="token punctuation">.</span>Staff                <span class="token keyword">select</span> emp<span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> emp <span class="token keyword">in</span> employees<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> Staff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Теперь добавим к сотрудникам их компанию:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Company<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> companies<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Staff<span class="token punctuation">,</span>                                    <span class="token punctuation">(</span>c<span class="token punctuation">,</span> emp<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> emp<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Company <span class="token operator">=</span> c<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> emp <span class="token keyword">in</span> employees<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Company</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> Staff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь применяется другая версия метода SelectMany. Первый делегат в виде&nbsp;<code>c =&gt; c.Staff</code>&nbsp;создает промежуточную коллекцию - фактически просто возвращаем набор сотрудников каждой компании. Второй делегат -&nbsp;<code>(c, emp)=&gt; new { Name = emp.Name, Company = c.Name }</code>&nbsp;получает каждую компанию и каждый элемент промежуточной коллекции - объект Person и на их основе создает анонимный объект с двумя свойствами Name и Company. Консольный вывод программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom <span class="token operator">-</span> Microsoft
Bob <span class="token operator">-</span> Microsoft
Sam <span class="token operator">-</span> Google
Mike <span class="token operator">-</span> Google
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогичный пример с помощью операторов запросов:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Company<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> <span class="token keyword">from</span> c <span class="token keyword">in</span> companies             <span class="token keyword">from</span> emp <span class="token keyword">in</span> c<span class="token punctuation">.</span>Staff             <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> emp<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Company <span class="token operator">=</span> c<span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> emp <span class="token keyword">in</span> employees<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Company</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span> Staff<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Фильтрация коллекции" class="heading" id="Фильтрация_коллекции"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Фильтрация коллекции</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Фильтрация коллекции" src="Фильтрация коллекции" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Фильтрация коллекции</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2153px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Фильтрация коллекции</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Для выбора элементов из некоторого набора по условию используется метод&nbsp;Where:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token generic-method"><span class="token function">Where</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> predicate<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Этот метод принимает делегат&nbsp;<code>Func&lt;TSource,bool&gt;</code>, который в качестве параметра принимает каждый элемент последовательности и возвращает значение bool. Если элемент соответствует некоторому условию, то возвращается true, и тогда этот элемент передается в коллекцию, которая возвращается из метода Where.</p></div><div><p>Например, выберем все строки, длина которых равна 3:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Tomas"</span><span class="token punctuation">,</span> <span class="token string">"Bill"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Tom", "Bob", "Sam", "Tim"foreach (string person in selectedPeople)    Console.WriteLine(person);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если выражение в методе Where для определенного элемента будет равно true (в данном случае выражение&nbsp;<code>p.Length == 3</code>), то данный элемент попадает в результирующую выборку.</p></div><div><p>Аналогичный запрос с помощью операторов LINQ:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Tomas"</span><span class="token punctuation">,</span> <span class="token string">"Bill"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people                     <span class="token keyword">where</span> <span class="token class-name">p</span><span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span>                     <span class="token keyword">select</span> p<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Другой пример - выберем все четные элементы, которые больше 10.</p></div><div><p>Фильтрация с помощью операторов LINQ:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// методы расширенияvar evens1 = numbers.Where(i =&gt; i % 2 == 0 &amp;&amp; i &gt; 10);// операторы запросовvar evens2 = from i in numbers            where i%2==0 &amp;&amp; i&gt;10            select i;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="heading-wrapper"><h3 data-heading="Выборка сложных объектов" class="heading" id="Выборка_сложных_объектов"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Выборка сложных объектов</h3><div class="heading-children"><div><p>Допустим, у нас есть класс пользователя:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Age<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> Languages<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Свойство Name представляет имя, свойство Age - возраст пользователя, а список Languages - список языков, которыми владеет пользователь.</p></div><div><p>Создадим набор пользователей и выберем из них тех, которым больше 25 лет:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token string">"english"</span><span class="token punctuation">,</span> <span class="token string">"german"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token string">"english"</span><span class="token punctuation">,</span> <span class="token string">"french"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">{</span> <span class="token string">"english"</span><span class="token punctuation">,</span> <span class="token string">"spanish"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span><span class="token string">"spanish"</span><span class="token punctuation">,</span> <span class="token string">"german"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people                     <span class="token keyword">where</span> <span class="token class-name">p</span><span class="token punctuation">.</span>Age <span class="token operator">&gt;</span> <span class="token number">25</span>                     <span class="token keyword">select</span> p<span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Person</span> person <span class="token keyword">in</span> selectedPeople<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">person<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">person<span class="token punctuation">.</span>Age</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Bob <span class="token operator">-</span> <span class="token number">27</span>
Sam <span class="token operator">-</span> <span class="token number">29</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогичный запрос с помощью метода расширения&nbsp;<code>Where</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Age <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Сложные фильтры" class="heading" id="Сложные_фильтры"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Сложные фильтры</h3><div class="heading-children"><div><p>Теперь рассмотрим более сложные фильтры. Например, в классе пользователя есть список языков, которыми владеет пользователь. Что если нам надо отфильтровать пользователей по языку:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> <span class="token keyword">from</span> person <span class="token keyword">in</span> people                    <span class="token keyword">from</span> lang <span class="token keyword">in</span> person<span class="token punctuation">.</span>Languages                    <span class="token keyword">where</span> <span class="token class-name">person</span><span class="token punctuation">.</span>Age <span class="token operator">&lt;</span> <span class="token number">28</span>                    <span class="token keyword">where</span> <span class="token class-name">lang</span> <span class="token operator">==</span> <span class="token string">"english"</span>                    <span class="token keyword">select</span> person<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результат:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom <span class="token operator">-</span> <span class="token number">23</span>
Bob <span class="token operator">-</span> <span class="token number">27</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Для создания аналогичного запроса с помощью методов расширения применяется метод&nbsp;<strong>SelectMany</strong>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span>u <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span>Languages<span class="token punctuation">,</span>            <span class="token punctuation">(</span>u<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Person <span class="token operator">=</span> u<span class="token punctuation">,</span> Lang <span class="token operator">=</span> l <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>u <span class="token operator">=&gt;</span> u<span class="token punctuation">.</span>Lang <span class="token operator">==</span> <span class="token string">"english"</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">.</span>Person<span class="token punctuation">.</span>Age <span class="token operator">&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>u<span class="token operator">=&gt;</span>u<span class="token punctuation">.</span>Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод&nbsp;<code>SelectMany()</code>&nbsp;в качестве первого параметра принимает последовательность, которую надо проецировать, а в качестве второго параметра - функцию преобразования, которая применяется к каждому элементу. На выходе она возвращает 8 пар “пользователь - язык” (new { Person = u, Lang = l }), к которым потом применяется фильтр с помощью Where.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Фильтрация по типу данных" class="heading" id="Фильтрация_по_типу_данных"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Фильтрация по типу данных</h3><div class="heading-children"><div><p>Дополнительный метод расширения -&nbsp;<code>OfType()</code>&nbsp;позволяет отфильтровать данные коллекции по определенному типу:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
<span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> student <span class="token keyword">in</span> students<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token function">Person</span><span class="token punctuation">(</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Employee</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">Person</span><span class="token punctuation">(</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае список people содержит объекты трех типов - класса Person и производных типов Student и Employee. И в примере производится фильтрация данных типа Student - для этого метод&nbsp;<code>OfType()</code>&nbsp;типизируется типом Student. Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom
Bob
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Методы Skip и Take" class="heading" id="Методы_Skip_и_Take"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Методы Skip и Take</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Методы Skip и Take" src="Методы Skip и Take" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Методы Skip и Take</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2251px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Методы Skip и Take</div></div><div><p>Ряд методов в LINQ позволяют получить часть коллекции, в частности, такие методы как Skip, Take, SkipWhile, TakeWhile.</p></div><div class="heading-wrapper"><h3 data-heading="Skip" class="heading" id="Skip"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Skip</h3><div class="heading-children"><div><p>Метод&nbsp;Skip()&nbsp;пропускает определенное количество элементов. Количество пропускаемых элементов передается в качестве параметра в метод:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Bob", "Mike", "Kate" };// пропускаем первые два элементаvar result = people.Skip(2);    // "Bob", "Mike", "Kate"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае пропускаем первые два элемента. Консольный вывод:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">Bob
Mike
Kate
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если необходимо пропустить определенное количество элементов с конца коллекции, то применяется метод&nbsp;SkipLast():</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Bob", "Mike", "Kate" };// пропускаем последние два элементаvar result = people.SkipLast(2);    // "Tom", "Sam", "Bob"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае пропускаем последние два элемента. Консольный вывод:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">Tom
Sam
Bob
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="SkipWhile" class="heading" id="SkipWhile"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>SkipWhile</h3><div class="heading-children"><div><p>Метод&nbsp;SkipWhile()&nbsp;пропускает цепочку элементов, начиная с первого элемента, пока они удовлетворяют определенному условию:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">SkipWhile(Func&lt;TSource, bool&gt; predicate);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В метод передается делегат, который представляет условие, он получает каждый элемент коллекции и возвращает значение true, если элемент соответствует условию. Например:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Mike", "Kate", "Bob" };// пропускаем первые элементы, длина которых равна 3var result = people.SkipWhile(p=&gt; p.Length == 3);    // "Mike", "Kate", "Bob"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь метод SkipWhile пропускает элементы, длина которых равна 3 символам. Первые два элемента массива people (“Tom”, “Sam”) соответствуют этому условию и поэтому будут пропущены. На третьем элементе (“Mike”) цепочка обрывается, поэтому последний элемент (“Bob”), длина которго тоже равна 3-м символам, не будет пропущен и будет включен в выходную коллекцию:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">Mike
Kate
Bob
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если в массиве первый элемент имел бы длину больше или меньше 3 символов, то цепочка пропускаемых элементов прервалась бы уже на первом элементе, и поэтому метод SkipWhile возвратил бы все элементы массива.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Take" class="heading" id="Take"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Take</h3><div class="heading-children"><div><p>Метод&nbsp;Take()&nbsp;извлекает определенное число элементов. Количество извлекаемых элементов передается в метод в качестве параметра. Например, извлечем три первых элемента:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Mike", "Kate", "Bob" };// извлекаем первые 3 элементаvar result = people.Take(3);    // "Tom", "Sam", "Mike"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод&nbsp;TakeLast()&nbsp;извлекает определенное количество элементов с конце коллекции:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Mike", "Kate", "Bob" };// извлекаем последние 3 элементаvar result = people.TakeLast(3);    // "Mike", "Kate", "Bob"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="TakeWhile" class="heading" id="TakeWhile"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>TakeWhile</h3><div class="heading-children"><div><p>Метод&nbsp;TakeWhile()&nbsp;выбирает цепочку элементов, начиная с первого элемента, пока они удовлетворяют определенному условию:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">TakeWhile(Func&lt;TSource, bool&gt; predicate);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В метод передается делегат, который представляет условие, он получает каждый элемент коллекции и возвращает значение true, если элемент соответствует условию. Например:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Mike", "Kate", "Bob" };// извлекаем первые элементы, длина которых равна 3var result = people.TakeWhile(p=&gt; p.Length == 3);    // "Tom", "Sam"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь метод TakeWhile выбирает элементы, длина которых равна 3 символам. Первые два элемента массива people (“Tom”, “Sam”) соответствуют этому условию и поэтому будут выбраны в выходную коллекцию. На третьем элементе (“Mike”) цепочка обрывается, поэтому последний элемент (“Bob”), длина которго тоже равна 3-м символам, не будет включен в выходную коллекцию:</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">Tom
Sam
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если бы первый элемент в массиве имел бы длину больше или меньше 3 символов, то в этом случае метод TakeWhile возвратил бы нам 0 элементов.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Постраничный вывод" class="heading" id="Постраничный_вывод"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Постраничный вывод</h3><div class="heading-children"><div><p>Совмещая оба метода - Take и Skip, мы можем выбрать определенное количество элементов начиная с определенного элемента. Например, выберем два элемента, начиная со четвертого (то есть пропустим 3 первых элемента):</p></div><div><pre class="language-plain" tabindex="0"><code class="language-plain is-loaded">string[] people = { "Tom", "Sam", "Mike", "Kate", "Bob", "Alice" };// пропускаем 3 элемента и выбираем 2 элементаvar result = people.Skip(3).Take(2);    // "Kate", "Bob"foreach (var person in result)    Console.WriteLine(person);
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Сортировка" class="heading" id="Сортировка"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Сортировка</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Сортировка" src="Сортировка" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Сортировка</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2708px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Сортировка</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div class="heading-wrapper"><h3 data-heading="Оператор orderby и метод OrderBy" class="heading" id="Оператор_orderby_и_метод_OrderBy"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Оператор orderby и метод OrderBy</h3><div class="heading-children"><div><p>Для сортировки набора данных в LINQ можно применять оператор&nbsp;<code>orderby</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedNumbers <span class="token operator">=</span> <span class="token keyword">from</span> i <span class="token keyword">in</span> numbers                     <span class="token keyword">orderby</span> i                     <span class="token keyword">select</span> i<span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token keyword">in</span> orderedNumbers<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Оператор&nbsp;<code>orderby</code>&nbsp;принимает критерий сортировки. В данном случае в качестве критерия выступает само число. Результат работы программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token number">3</span>
<span class="token number">4</span>
<span class="token number">10</span>
<span class="token number">12</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если числа сортируются стандартным образом, как принято в математике, то строки сортируются исходя из алфавитного порядка:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedPeople <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people <span class="token keyword">orderby</span> p <span class="token keyword">select</span> p<span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> p <span class="token keyword">in</span> orderedPeople<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// Bob Sam Tom</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Вместо оператора orderby можно применять метод расширения&nbsp;OrderBy():</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">OrderBy <span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> keySelector<span class="token punctuation">)</span>OrderBy <span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> keySelector<span class="token punctuation">,</span> <span class="token class-name">IComparer<span class="token punctuation">&lt;</span>TKey<span class="token punctuation">&gt;</span><span class="token punctuation">?</span></span> comparer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Первая версия метода получает делегат, который через параметр получает элемент коллекции и который возвращает значение, применяемое для сортировки. Вторая версия позволяет также задать принцип сортировки через реализацию интерфейса IComparer.</p></div><div><p>Перепишем предыдущие два примера с помощью метода OrderBy:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedNumbers <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>n<span class="token operator">=&gt;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token keyword">in</span> orderedNumbers<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> p <span class="token keyword">in</span> orderedPeople<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Сортировка сложных объектов" class="heading" id="Сортировка_сложных_объектов"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Сортировка сложных объектов</h3><div class="heading-children"><div><p>Возьмем посложнее пример. Допустим, надо отсортировать выборку сложных объектов. Тогда в качестве критерия мы можем указать свойство класса объекта:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// с помощью оператора orderbyvar sortedPeople1 = from p in people                  orderby p.Name                  select p;foreach (var p in sortedPeople1)    Console.WriteLine($"{p.Name} - {p.Age}");// с помощью метода OrderByvar sortedPeople2 = people.OrderBy(p =&gt; p.Name);foreach (var p in sortedPeople2)    Console.WriteLine($"{p.Name} - {p.Age}");record class Person(string Name, int Age);</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Сортировка по возрастанию и убыванию" class="heading" id="Сортировка_по_возрастанию_и_убыванию"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Сортировка по возрастанию и убыванию</h3><div class="heading-children"><div><p>По умолчанию оператор&nbsp;<code>orderby</code>&nbsp;и метод OrderBy производят сортировку по возрастанию. С помощью ключевых слов&nbsp;ascending&nbsp;(сортировка по возрастанию) и&nbsp;descending&nbsp;(сортировка по убыванию) для оператора&nbsp;<code>orderby</code>&nbsp;можно явным образом указать направление сортировки. Например, отсортируем массив чисел по убыванию:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedNumbers <span class="token operator">=</span> <span class="token keyword">from</span> i <span class="token keyword">in</span> numbers                     <span class="token keyword">orderby</span> i <span class="token keyword">descending</span>                     <span class="token keyword">select</span> i<span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token keyword">in</span> orderedNumbers<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 12 10 4 3</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Для сортировки по убыванию можно применять метод&nbsp;OrderByDescending(), который работает аналогично OrderBy за исключением направления сортировки:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> orderedNumbers <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token keyword">in</span> orderedNumbers<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 12 10 4 3</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Множественные критерии сортировки" class="heading" id="Множественные_критерии_сортировки"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Множественные критерии сортировки</h3><div class="heading-children"><div><p>В наборах сложных объектов иногда встает ситуация, когда надо отсортировать не по одному, а сразу по нескольким полям. Для этого в запросе LINQ все критерии указываются в порядке приоритета через запятую:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Person<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// с помощью оператора orderbyvar sortedPeople1 = from p in people                  orderby p.Name, p.Age                  select p;foreach (var p in sortedPeople1)    Console.WriteLine($"{p.Name} - {p.Age}");</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результат программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Bob <span class="token operator">-</span> <span class="token number">41</span>
Sam <span class="token operator">-</span> <span class="token number">28</span>
Tom <span class="token operator">-</span> <span class="token number">22</span>
Tom <span class="token operator">-</span> <span class="token number">37</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Для разных критериев сортировки можно установить направление:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token comment">// с помощью оператора orderbyvar sortedPeople1 = from p in people                  orderby p.Name, p.Age descending  // сортировка по возрасту по убыванию                  select p;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>С помощью методов расширения то же самое можно сделать через метод&nbsp;<code>ThenBy()</code> (для сортировки по возрастанию) и&nbsp;<code>ThenByDescending()</code>&nbsp;(для сортировки по убыванию):</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> sortedPeople2 <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">ThenByDescending</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span>p<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результат будет аналогичен предыдущему.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Переопределение критерия сортировки" class="heading" id="Переопределение_критерия_сортировки"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Переопределение критерия сортировки</h3><div class="heading-children"><div><p>С помощью реализации IComparer мы можем переопределить критерии сортировки, если они нас не устраивают. Например, строки по умолчанию сортируются в алфавитном порядке. Но что, если мы хотим сортировать строки исходя из их длины? Решим данную задачу:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> sortedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CustomStringComparer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> p <span class="token keyword">in</span> sortedPeople<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// сравнение по длине строкиclass CustomStringComparer : IComparer&lt;String&gt;{    public int Compare(string? x, string? y)    {        int xLength = x?.Length ?? 0; // если x равно null, то длина 0        int yLength = y?.Length ?? 0;        return xLength - yLength;    }}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Интерфейс IComparer типизируется типов сортируемых данных (в данном случае типом String). Для реализации этого интерфейса необходимо определить метод Compare. Он возвращает число: если первый параметр больше второго, то число больше 0, если меньше - то число меньше 0. Если оба параметра равны, то возвращается 0.</p></div><div><p>В данном случае, если параметр равен null, будем считать что длина строки равна 0. И с помощью разницы длин строк из обоих параметров определяем, какой из них больше.</p></div><div><p>Результат программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom
Sam
Kate
Mike
Alice
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Объединение, пересечение и разность коллекций" class="heading" id="Объединение,_пересечение_и_разность_коллекций"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Объединение, пересечение и разность коллекций</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Объединение, пересечение и разность коллекций" src="Объединение, пересечение и разность коллекций" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Объединение, пересечение и разность коллекций</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2765px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Объединение, пересечение и разность коллекций</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>LINQ предоставляет несколько методов для работы с коллекциями как с множествами, а именно находить их разность, объединение и пересечение.</p></div><div class="heading-wrapper"><h3 data-heading="Разность последовательностей" class="heading" id="Разность_последовательностей"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Разность последовательностей</h3><div class="heading-children"><div><p>С помощью метода&nbsp;Except()&nbsp;можно получить разность двух последовательностей:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> soft <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Apple"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> hard <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"IBM"</span><span class="token punctuation">,</span> <span class="token string">"Samsung"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// разность последовательностейvar result = soft.Except(hard);foreach (string s in result)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае из массива&nbsp;<code>soft</code>&nbsp;убираются все элементы, которые есть в массиве&nbsp;<code>hard</code>. Результатом операции будут два элемента:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft
Google
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Пересечение последовательностей" class="heading" id="Пересечение_последовательностей"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Пересечение последовательностей</h3><div class="heading-children"><div><p>Для получения пересечения последовательностей, то есть общих для обоих наборов элементов, применяется метод&nbsp;<code>Intersect</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> soft <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Apple"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> hard <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"IBM"</span><span class="token punctuation">,</span> <span class="token string">"Samsung"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// пересечение последовательностейvar result = soft.Intersect(hard);foreach (string s in result)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Так как оба набора имеют только один общий элемент, то соответственно только он и попадет в результирующую выборку:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Apple
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Удаление дубликатов" class="heading" id="Удаление_дубликатов"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Удаление дубликатов</h3><div class="heading-children"><div><p>Для удаления дублей в наборе используется метод&nbsp;Distinct:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> soft <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// удаление дублейvar result = soft.Distinct();foreach (string s in result)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft
Google
Apple
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Объединение последовательностей" class="heading" id="Объединение_последовательностей"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Объединение последовательностей</h3><div class="heading-children"><div><p>Для объединения двух последовательностей используется метод&nbsp;Union. Его результатом является новый набор, в котором имеются элементы, как из первой, так и из второй последовательности. Повторяющиеся элементы добавляются в результат только один раз:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> soft <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Apple"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> hard <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"IBM"</span><span class="token punctuation">,</span> <span class="token string">"Samsung"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// объединение последовательностейvar result = soft.Union(hard);foreach (string s in result)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результатом операции будет следующий набор:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft
Google
Apple
IBM
Samsung
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если же нам нужно простое объединение двух наборов, то мы можем использовать метод&nbsp;Concat:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> soft<span class="token punctuation">.</span><span class="token function">Concat</span><span class="token punctuation">(</span>hard<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В этом случае те элементы, которые встречаются в обоих наборах, дублируются в резутирующей последовательности.</p></div><div><p>Последовательное применение методов Concat и Distinct будет подобно действию метода Union.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Работа со сложными объектами" class="heading" id="Работа_со_сложными_объектами"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Работа со сложными объектами</h3><div class="heading-children"><div><p>Для сравнения объектов в последовательностях применяются реализации методов <code>GetHashCode()</code> и <code>Equals()</code>. Поэтому если мы хотим работать с последовательностями, которые содержат объекты своих классов и структур, то нам необходимо определить для них подобные методы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> students <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> employees <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// объединение последовательностейvar people = students.Union(employees);foreach (Person person in people)    Console.WriteLine(person.Name);class Person{    public string Name { get;}    public Person(string name) =&gt; Name = name;    public override bool Equals(object? obj)    {        if (obj is Person person) return Name == person.Name;        return false;    }    public override int GetHashCode() =&gt; Name.GetHashCode();}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь объекты Person сравниваются исходя из значения их свойства Name - если имена равны, то и объекты Person равны. Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom
Bob
Sam
Mike
</code><button class="copy-code-button">Copy</button></pre></div><div><hr></div></div></div><div class="heading-wrapper"><h3 data-heading="Comments:" class="heading" id="Comments:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Comments:</h3><div class="heading-children"></div></div><div class="heading-wrapper"><h3 data-heading="Віталік Бречко:" class="heading" id="Віталік_Бречко:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Віталік Бречко:</h3><div class="heading-children"><div><p>Пара слов о перечисленных в статье методах. Для определения эквивалентности они используют методы GetHeshCode() &amp; Equals(). Если вам нужно работать с коллекцией объектов вашего класса, то эти методы, возможно, придется в нём переопределить.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">class</span> <span class="token class-name">Program</span>    <span class="token punctuation">{</span>        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token class-name">List<span class="token punctuation">&lt;</span> User<span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span> User<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">{</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">33</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">33</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">21</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">43</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Jack"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Maks"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">21</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Nikita"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">103</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">User</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token keyword">in</span> users<span class="token punctuation">)</span>                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">user<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">user<span class="token punctuation">.</span>Age</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token keyword">var</span></span> distinctedUsers <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">Distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"==================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token keyword">in</span> distinctedUsers<span class="token punctuation">)</span>                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">user<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">user<span class="token punctuation">.</span>Age</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">User</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Age <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Equals</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> obj<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> obj <span class="token keyword">is</span> <span class="token class-name">User</span> user <span class="token operator">&amp;&amp;</span>                   Name <span class="token operator">==</span> user<span class="token punctuation">.</span>Name <span class="token operator">&amp;&amp;</span>                   Age <span class="token operator">==</span> user<span class="token punctuation">.</span>Age<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">return</span> HashCode<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Name<span class="token punctuation">,</span> Age<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Григорий:" class="heading" id="Григорий:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Григорий:</h3><div class="heading-children"><div><p>Касательно последнего примера про выборку сложных объектов.</p></div><div><p>Метод Equals по умолчанию работает с object типом, из-за чего каждый раз будет происходить боксинг-анбоксинг при проверка каждого из элементов списка, что не самым лучшим образом влияет на производительность.</p></div><div><p>Нужно реализовать интерфейс <code>IEquatable&lt;t&gt;</code>, чтобы решить эту проблему (это вариант Eqauls с универсальным типом)</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> students <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> employees <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// объединение последовательностейvar people = students.Union(employees);foreach (Person person in people)    Console.WriteLine(person.Name);class Person : IEquatable&lt;person&gt;{    public string Name { get; }    public Person(string name) =&gt; Name = name;    public bool Equals(Person? obj)    {        if (obj is null) return false;        return obj.Name == Name;    }    public override int GetHashCode() =&gt; Name.GetHashCode();}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В этом случае боксинг и анбоксинг происходить не будет. Вот более подробно про это -&nbsp;<a data-tooltip-position="top" aria-label="https://learn.microsoft.com/ru-ru/dotnet/api/system.linq.enumerable.union?view=net-7.0" rel="noopener" class="external-link" href="https://learn.microsoft.com/ru-ru/dotnet/api/system.linq.enumerable.union?view=net-7.0" target="_blank">https://learn.microsoft.com…</a></p></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Агрегатные операции" class="heading" id="Агрегатные_операции"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Агрегатные операции</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Агрегатные операции" src="Агрегатные операции" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Агрегатные операции</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 1725px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Агрегатные операции</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>К агрегатным операциям относят различные операции над выборкой, например, получение числа элементов, получение минимального, максимального и среднего значения в выборке, а также суммирование значений.</p></div><div class="heading-wrapper"><h3 data-heading="Метод Aggregate" class="heading" id="Метод_Aggregate"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Метод Aggregate</h3><div class="heading-children"><div><p>Метод Aggregate выполняет общую агрегацию элементов коллекции в зависимости от указанного выражения. Например:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> query <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">=&gt;</span> x <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// -13</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Переменная query будет представлять результат агрегации массива. В качестве условия агрегации используется выражение&nbsp;<code>(x,y)=&gt; x - y</code>, то есть вначале из первого элемента вычитается второй, потом из получившегося значения вычитается третий и так далее. То есть будет эквивалентно выражению:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span></span> query <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token number">5</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В итоге мы получим число -13. Соответственно мы бы могли использовать любые другие операции, например, сложение:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span></span> query <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// аналогично 1 + 2 + 3 + 4 + 5</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Еще одна версия метода позволяет задать начальное значение, с которого начинается цепь агрегатных операций:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> words <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Gaudeamus"</span><span class="token punctuation">,</span> <span class="token string">"igitur"</span><span class="token punctuation">,</span> <span class="token string">"Juvenes"</span><span class="token punctuation">,</span> <span class="token string">"dum"</span><span class="token punctuation">,</span> <span class="token string">"sumus"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> sentence <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token string">"Text:"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>first<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">first</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">next</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>sentence<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Text: Gaudeamus igitur Juvenes dum sumus</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае объединяются все элементы массива words, но первым элемент агрегатной операции будет строка “Text:”.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Получение размера выборки. Метод Count" class="heading" id="Получение_размера_выборки._Метод_Count"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Получение размера выборки. Метод Count</h3><div class="heading-children"><div><p>Для получения числа элементов в выборке используется метод&nbsp;Count():</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> size <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 10Console.WriteLine(size);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод&nbsp;<code>Count()</code>&nbsp;в одной из версий также может принимать лямбда-выражение, которое устанавливает условие выборки. Поэтому мы можем в данном случае не использовать выражение&nbsp;<code>Where</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//  количество четных чисел, которые больше 10int size = numbers.Count(i =&gt; i % 2 == 0 &amp;&amp; i &gt; 10);Console.WriteLine(size);    // 3</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Получение суммы" class="heading" id="Получение_суммы"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Получение суммы</h3><div class="heading-children"><div><p>Для получения суммы значений применяется метод&nbsp;Sum:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> sum <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 340</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод&nbsp;<code>Sum()</code>&nbsp;имеет ряд перегрузок. В частности, если у нас набор сложных объектов, как в примере выше, то мы можем указать свойство, значения которого будут суммироваться:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> ageSum <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>ageSum<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 106record class Person(string Name, int Age);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае вычисляется сумма значений свойств Age объектов Person из массива people.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Максимальное, минимальное и среднее значения" class="heading" id="Максимальное,_минимальное_и_среднее_значения"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Максимальное, минимальное и среднее значения</h3><div class="heading-children"><div><p>Для нахождения минимального значения применяется метод&nbsp;Min(), для получения максимального - метод&nbsp;Max(), а для нахождения среднего значения - метод&nbsp;Average(). Их действие похоже на методы Sum и Count:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> min <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> max <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">double</span></span> average <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Average</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Min: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">min</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// Min: 1Console.WriteLine($"Max: {max}");           // Max: 88Console.WriteLine($"Average: {average}");   // Average: 34</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если мы работаем со сложными объектами, то в эти методы передается делегат, который принимает свойство, применяемое в вычислениях:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">int</span></span> minAge <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// минимальный возрастint maxAge = people.Max(p =&gt; p.Age); // максимальный возрастdouble averageAge = people.Average(p =&gt; p.Age); //средний возрастConsole.WriteLine($"Min Age: {minAge}");           // Min Age: 28Console.WriteLine($"Max Age: {maxAge}");           // Max Age: 41Console.WriteLine($"Average Age: {averageAge}");   // Average Age: 35,33record class Person(string Name, int Age);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае для вычислений применяется свойство Age, то есть вычисляется минимальный, максимальный и средний возраст.</p></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Группировка" class="heading" id="Группировка"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Группировка</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Группировка" src="Группировка" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Группировка</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2942px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Группировка</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Для группировки данных по определенным параметрам применяется оператор&nbsp;group by&nbsp;и метод&nbsp;GroupBy().</p></div><div class="heading-wrapper"><h3 data-heading="Оператор group by" class="heading" id="Оператор_group_by"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Оператор group by</h3><div class="heading-children"><div><p>Допустим, у нас есть набор из объектов следующего типа:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Company<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Данный класс представляет пользователя и имеет два свойства: Name (имя пользователя) и Company (компания, где работает пользователь). Сгруппируем набор пользователей по компании:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">from</span> person <span class="token keyword">in</span> people                <span class="token keyword">group</span> person <span class="token keyword">by</span> person<span class="token punctuation">.</span>Company<span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> company <span class="token keyword">in</span> companies<span class="token punctuation">)</span><span class="token punctuation">{</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>company<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> person <span class="token keyword">in</span> company<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// для разделения между группами}record class Person(string Name, string Company);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Если в выражении LINQ последним оператором, выполняющим операции над выборкой, является&nbsp;<code>group</code>, то оператор&nbsp;<code>select</code>&nbsp;не применяется.</p></div><div><p>Оператор&nbsp;<code>group</code>&nbsp;принимает критерий по которому проводится группировка:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">group</span> person <span class="token keyword">by</span> person<span class="token punctuation">.</span>Company
</code><button class="copy-code-button">Copy</button></pre></div><div><p>в данном случае группировка идет по свойству Company. Результатом оператора&nbsp;<code>group</code>&nbsp;является выборка, которая состоит из групп. Каждая группа представляет объект&nbsp;IGrouping&lt;K, V&gt;: параметр&nbsp;<code>K</code>&nbsp;указывает на тип ключа - тип свойства, по которому идет группировка (здесь это тип string). А параметр&nbsp;<code>V</code>&nbsp;представляет тип сгруппированных объектов - в данном случае группируем объекты Person.</p></div><div><p>Каждая группа имеет ключ, который мы можем получить через свойство Key:&nbsp;<code>g.Key</code>. Здесь это будет название компании.</p></div><div><p>Все элементы внутри группы можно получить с помощью дополнительной итерации. Элементы группы имеют тот же тип, что и тип объектов, которые передавались оператору&nbsp;<code>group</code>, то есть в данном случае объекты типа&nbsp;<code>Person</code>.</p></div><div><p>В итоге мы получим следующий вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft
Tom
Mike
Alice

Google
Sam

JetBrains
Bob
Kate
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="GroupBy" class="heading" id="GroupBy"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>GroupBy</h3><div class="heading-children"><div><p>В качестве альтернативы можно использовать метод расширения&nbsp;GroupBy. Он имеет ряд перегрузок, возьмем самую простую из них:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token generic-method"><span class="token function">GroupBy</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> keySelector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Данная версия получает делегат, которые в качестве параметра принимает каждый элемент коллекции и возвращает критерий группировки.</p></div><div><p>Перепишем предыдущий пример с помощью метода GroupBy:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>Company<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> company <span class="token keyword">in</span> companies<span class="token punctuation">)</span><span class="token punctuation">{</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>company<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> person <span class="token keyword">in</span> company<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// для разделения между группами}record class Person(string Name, string Company);</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Создание нового объекта при группировке" class="heading" id="Создание_нового_объекта_при_группировке"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Создание нового объекта при группировке</h3><div class="heading-children"><div><p>Теперь изменим запрос и создадим из группы новый объект:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">from</span> person <span class="token keyword">in</span> people                <span class="token keyword">group</span> person <span class="token keyword">by</span> person<span class="token punctuation">.</span>Company <span class="token keyword">into</span> g                <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> Count <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> company <span class="token keyword">in</span> companies<span class="token punctuation">)</span><span class="token punctuation">{</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">company<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">company<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Company<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Выражение</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">group</span> person <span class="token keyword">by</span> person<span class="token punctuation">.</span>Company <span class="token keyword">into</span> g
</code><button class="copy-code-button">Copy</button></pre></div><div><p>определяет переменную&nbsp;<code>g</code>, которая будет содержать группу. С помощью этой переменной мы можем затем создать новый объект анонимного типа (хотя также можно под данную задачу определить новый класс):</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> Count <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Теперь результат запроса LINQ будет представлять набор объектов таких анонимных типов, у которых два свойства Name и Count.</p></div><div><p>Результат программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft <span class="token punctuation">:</span> <span class="token number">3</span>
Google <span class="token punctuation">:</span> <span class="token number">1</span>
JetBrains <span class="token punctuation">:</span> <span class="token number">2</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогичная операция с помощью метода&nbsp;<code>GroupBy()</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> people                    <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span>p<span class="token punctuation">.</span>Company<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>g <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> Count <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Вложенные запросы" class="heading" id="Вложенные_запросы"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Вложенные запросы</h3><div class="heading-children"><div><p>Также мы можем осуществлять вложенные запросы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> <span class="token keyword">from</span> person <span class="token keyword">in</span> people                <span class="token keyword">group</span> person <span class="token keyword">by</span> person<span class="token punctuation">.</span>Company <span class="token keyword">into</span> g                <span class="token keyword">select</span> <span class="token keyword">new</span>                <span class="token punctuation">{</span>                    Name <span class="token operator">=</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>                    Count <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    Employees <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> g <span class="token keyword">select</span> p                <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> company <span class="token keyword">in</span> companies<span class="token punctuation">)</span><span class="token punctuation">{</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">company<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">company<span class="token punctuation">.</span>Count</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> employee <span class="token keyword">in</span> company<span class="token punctuation">.</span>Employees<span class="token punctuation">)</span>    <span class="token punctuation">{</span>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// для разделения компаний}record class Person(string Name, string Company);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь свойство Employees каждой группы формируется с помощью дополнительного запроса, который выбирает всех пользователей в этой группе. Консольный вывод программы:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft <span class="token punctuation">:</span> <span class="token number">3</span>
Tom
Mike
<span class="token class-name">Alice</span>

Google <span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token class-name">Sam</span>

JetBrains <span class="token punctuation">:</span> <span class="token number">2</span>
Bob
Kate
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Аналогичный запрос с помощью метода <code>GroupBy</code>:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> companies <span class="token operator">=</span> people                    <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span>p<span class="token punctuation">.</span>Company<span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>g <span class="token operator">=&gt;</span> <span class="token keyword">new</span>                    <span class="token punctuation">{</span>                        Name <span class="token operator">=</span> g<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>                        Count <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        Employees <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>p<span class="token operator">=&gt;</span> p<span class="token punctuation">)</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Соединение коллекций" class="heading" id="Соединение_коллекций"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Соединение коллекций</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Соединение коллекций" src="Соединение коллекций" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Соединение коллекций</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2981px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Соединение коллекций</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Соединение в LINQ используется для объединения двух разнотипных наборов в один. Для соединения используется оператор <code>join</code> или метод <code>Join()</code>. Как правило, данная операция применяется к двум наборам, которые имеют один общий критерий.</p></div><div class="heading-wrapper"><h3 data-heading="Оператор join" class="heading" id="Оператор_join"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Оператор join</h3><div class="heading-children"><div><p>Оператор join имеет следующий формальный синтаксис:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">from объект<span class="token number">1</span> <span class="token keyword">in</span> набор1join объект<span class="token number">2</span> <span class="token keyword">in</span> набор<span class="token number">2</span> <span class="token keyword">on</span> объект<span class="token number">2</span><span class="token punctuation">.</span>свойство<span class="token number">2</span> equals объект<span class="token number">1</span><span class="token punctuation">.</span>свойство<span class="token number">1</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>После оператора join идет выборка объектов из второй коллекции. После оператора <code>on</code> указывается критерий соединения - свойство объекта из второй выборки, а после оператора <code>equals</code> - свойство объекта из первой выборки, которому должно быть равно свойство объекта из второй выборки. Если эти свойства равны, то оба объекта попадают в финальный результат.</p></div><div><p>Например, у нас есть два класса:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Company<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Title<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Language<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Класс Person представляет пользователя и хранит два свойства: Name (имя) и Company (компания пользователя). Класс Company представляет компанию и хранит два свойства: Title (название компании) и Language (основной язык программирования в компании)</p></div><div><p>Объекты обоих классов будет иметь один общий критерий - название компании. Соединим по этому критерию два набора этих классов:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Company<span class="token punctuation">[</span><span class="token punctuation">]</span></span> companies <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Go"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Oracle"</span><span class="token punctuation">,</span> <span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> <span class="token keyword">from</span> p <span class="token keyword">in</span> people             <span class="token keyword">join</span> c <span class="token keyword">in</span> companies <span class="token keyword">on</span> p<span class="token punctuation">.</span>Company equals c<span class="token punctuation">.</span>Title             <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> p<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Company <span class="token operator">=</span> c<span class="token punctuation">.</span>Title<span class="token punctuation">,</span> Language <span class="token operator">=</span> c<span class="token punctuation">.</span>Language <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> emp <span class="token keyword">in</span> employees<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Company</span><span class="token punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">emp<span class="token punctuation">.</span>Language</span><span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Company<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Company</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Title<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> Language<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В итоге мы получим следующий вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Tom <span class="token operator">-</span> Microsoft <span class="token punctuation">(</span>C#<span class="token punctuation">)</span>
Sam <span class="token operator">-</span> Google <span class="token punctuation">(</span>Go<span class="token punctuation">)</span>
Mike <span class="token operator">-</span> Microsoft <span class="token punctuation">(</span>C#<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Обратите внимание, что в массиве people есть объект <code>new Person("Bob", "JetBrains")</code>, но в массиве компаний компании с именем “JetBrains” нет, соответственно он не попал с результат. Аналогично в списке people нет объектов Person, которые бы соотствовали компании <code>new Company("Oracle", "Java")</code>.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Метод Join" class="heading" id="Метод_Join"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Метод Join</h3><div class="heading-children"><div><p>В качестве альтернативы можно было бы использовать метод Join():</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token function">Join</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TInner<span class="token punctuation">&gt;</span></span> inner<span class="token punctuation">,</span>    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TOuter<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> outerKeySelector<span class="token punctuation">,</span>    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TInner<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> innerKeySelector<span class="token punctuation">,</span>    <span class="token class-name">Func<span class="token punctuation">&lt;</span>TOuter<span class="token punctuation">,</span>TInner<span class="token punctuation">,</span>TResult<span class="token punctuation">&gt;</span></span> resultSelector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод <code>Join()</code> принимает четыре параметра:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>второй список, который соединяем с текущим</li>
<li data-line="1"><div class="list-bullet"></div>делегат, который определяет свойство объекта из текущего списка, по которому идет соединение</li>
<li data-line="2"><div class="list-bullet"></div>делегат, который определяет свойство объекта из второго списка, по которому идет соединение</li>
<li data-line="3"><div class="list-bullet"></div>делегат, который определяет новый объект в результате соединения</li>
</ul></div><div><p>Перепишим предыдущий пример с использованием метода Join:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Company<span class="token punctuation">[</span><span class="token punctuation">]</span></span> companies <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Go"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Oracle"</span><span class="token punctuation">,</span> <span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> employees <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>companies<span class="token punctuation">,</span> <span class="token comment">// второй набор             p =&gt; p.Company, // свойство-селектор объекта из первого набора             c =&gt; c.Title, // свойство-селектор объекта из второго набора             (p, c) =&gt; new { Name = p.Name, Company = c.Title, Language = c.Language }); // результатforeach (var emp in employees)    Console.WriteLine($"{emp.Name} - {emp.Company} ({emp.Language})");record class Person(string Name, string Company);record class Company(string Title, string Language);</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="GroupJoin" class="heading" id="GroupJoin"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>GroupJoin</h3><div class="heading-children"><div><p>Метод GroupJoin() кроме соединения последовательностей также выполняет и группировку.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token function">GroupJoin</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TInner<span class="token punctuation">&gt;</span></span> inner<span class="token punctuation">,</span>        <span class="token class-name">Func<span class="token punctuation">&lt;</span>TOuter<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> outerKeySelector<span class="token punctuation">,</span>        <span class="token class-name">Func<span class="token punctuation">&lt;</span>TInner<span class="token punctuation">,</span>TKey<span class="token punctuation">&gt;</span></span> innerKeySelector<span class="token punctuation">,</span>        <span class="token class-name">Func<span class="token punctuation">&lt;</span>TOuter<span class="token punctuation">,</span> IEnumerable<span class="token punctuation">&lt;</span>TInner<span class="token punctuation">&gt;</span><span class="token punctuation">,</span>TResult<span class="token punctuation">&gt;</span></span> resultSelector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод <code>GroupJoin()</code> принимает четыре параметра:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>второй список, который соединяем с текущим</li>
<li data-line="1"><div class="list-bullet"></div>делегат, который определяет свойство объекта из текущей коллекции, по которому идет соединение и по которому будет идти группировка</li>
<li data-line="2"><div class="list-bullet"></div>делегат, который определяет свойство объекта из второй коллекции, по которому идет соединение</li>
<li data-line="3"><div class="list-bullet"></div>делегат, который определяет новый объект в результате соединения. Этот делегат получает группу - объект текущей коллекции, по которому шла группировка, и набор объектов из второй коллекции, которые сооставляют группу</li>
</ul></div><div><p>Например, возьмем выше определенные массивы people и companies и сгуппируем всех пользователей по компаниям:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Google"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"JetBrains"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Microsoft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name">Company<span class="token punctuation">[</span><span class="token punctuation">]</span></span> companies <span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Microsoft"</span><span class="token punctuation">,</span> <span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Go"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Company</span><span class="token punctuation">(</span><span class="token string">"Oracle"</span><span class="token punctuation">,</span> <span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> personnel <span class="token operator">=</span> companies<span class="token punctuation">.</span><span class="token function">GroupJoin</span><span class="token punctuation">(</span>people<span class="token punctuation">,</span> <span class="token comment">// второй набор             c =&gt; c.Title, // свойство-селектор объекта из первого набора             p =&gt; p.Company, // свойство-селектор объекта из второго набора             (c, employees) =&gt; new   // результат             {                 Title = c.Title,                 Employees = employees            });foreach (var company in personnel){    Console.WriteLine(company.Title);    foreach(var emp in company.Employees)    {        Console.WriteLine(emp.Name);    }    Console.WriteLine();}record class Person(string Name, string Company);record class Company(string Title, string Language);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результатом выполнения программы будет следующий вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Microsoft
Tom
Mike

Google
Sam

Oracle
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод GroupJoin, также как и метод Join, принимает все те же параметры. Только теперь в последний параметр - делегат передаются объект компании и набор пользователей этой компании.</p></div><div><p>Обратите внимание, что для компании “Oracle” в массиве people нет пользователей, хотя для нее также создается группа.</p></div><div><p>Аналогичного результата можно добитьс и с помощью оператора join:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> personnel <span class="token operator">=</span> <span class="token keyword">from</span> c <span class="token keyword">in</span> companies                <span class="token keyword">join</span> p <span class="token keyword">in</span> people <span class="token keyword">on</span> c<span class="token punctuation">.</span>Title equals p<span class="token punctuation">.</span>Company <span class="token keyword">into</span> g                <span class="token keyword">select</span> <span class="token keyword">new</span>   <span class="token comment">// результат                {                    Title = c.Title,                    Employees = g                };</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Метод Zip" class="heading" id="Метод_Zip"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Метод Zip</h3><div class="heading-children"><div><p>Метод Zip() последовательно объединяет соответствующие элементы текущей последовательности со второй последовательностью, которая передается в метод в качестве параметра. То есть первый элемент из первой последовательности объединяется с первым элементом из второй последовательности, второй элемент из первой последовательности соединяется со вторым элементом из второй последовательности и так далее. Результатом метода является коллекция кортежей, где каждый кортеж хранит пару соответствующих элементов из обоих последовательностей:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> courses <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Course<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Course</span><span class="token punctuation">(</span><span class="token string">"C#"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Course</span><span class="token punctuation">(</span><span class="token string">"Java"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> students <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Student<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> enrollments <span class="token operator">=</span> courses<span class="token punctuation">.</span><span class="token function">Zip</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> enrollment <span class="token keyword">in</span> enrollments<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">enrollment<span class="token punctuation">.</span>First</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">enrollment<span class="token punctuation">.</span>Second</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">class</span></span> <span class="token function">Course</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> Title<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// учебный курсrecord class Student(string Name);  // студент</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь метод Zip объединяет соответствующие элементы из списков courses и students. В результате создается новая коллекция, которая хранит набор кортежей. Каждый кортеж в ней имеет два элемента. Первый элемент из свойства First представляет объект текущей коллекции (в данном случае объект Course), а второй элемент (в свойстве Second) хранит объект второй последовательности (в данном случае объект Student). Консольный вывод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded">Course <span class="token punctuation">{</span> Title <span class="token operator">=</span> C# <span class="token punctuation">}</span> <span class="token operator">-</span> Student <span class="token punctuation">{</span> Name <span class="token operator">=</span> Tom <span class="token punctuation">}</span>
Course <span class="token punctuation">{</span> Title <span class="token operator">=</span> Java <span class="token punctuation">}</span> <span class="token operator">-</span> Student <span class="token punctuation">{</span> Name <span class="token operator">=</span> Bob <span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Проверка наличия и получение элементов" class="heading" id="Проверка_наличия_и_получение_элементов"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Проверка наличия и получение элементов</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Проверка наличия и получение элементов" src="Проверка наличия и получение элементов" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Проверка наличия и получение элементов</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 2910px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Проверка наличия и получение элементов</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Ряд методов в LINQ позволяют проверить наличие элементов в коллекции и получить их.</p></div><div class="heading-wrapper"><h3 data-heading="All" class="heading" id="All"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>All</h3><div class="heading-children"><div><p>Метод&nbsp;<code>All()</code>&nbsp;проверяет, соответствуют ли все элементы условию. Если все элементы соответствуют условию, то возвращается true. Например:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, все ли элементы имеют длину в 3 символаbool allHas3Chars = people.All(s =&gt; s.Length == 3);     // trueConsole.WriteLine(allHas3Chars);// проверяем, все ли строки начинаются на Tbool allStartsWithT = people.All(s =&gt; s.StartsWith("T"));   // falseConsole.WriteLine(allStartsWithT);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В первом случае проверяем, все ли строки в массиве people имеют длину в три символа. Поскольку это условие верно, то метод All возвращает true. Во втором случае смотрим, все ли строки начинаются с буквы “T”. это условие ложно, поэтому метод All возвращает false.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Any" class="heading" id="Any"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Any</h3><div class="heading-children"><div><p>Метод&nbsp;Any()&nbsp;действует подобным образом, только возвращает true, если хотя бы один элемент коллекции определенному условию:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, все ли элементы имеют длину больше 3 символовbool allHasMore3Chars = people.Any(s =&gt; s.Length &gt; 3);     // falseConsole.WriteLine(allHasMore3Chars);// проверяем, все ли строки начинаются на Tbool allStartsWithT = people.Any(s =&gt; s.StartsWith("T"));   // trueConsole.WriteLine(allStartsWithT);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Первое выражение вернет&nbsp;<code>false</code>, поскольку все строки имеют длину в 3 символа. Второе выражение возвратит&nbsp;<code>true</code>, так как у нас есть в коллекции есть строки, которые начинаются на букву T.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="Contains" class="heading" id="Contains"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Contains</h3><div class="heading-children"><div><p>Метод&nbsp;Contains()&nbsp;возвращает&nbsp;<code>true</code>, если коллекция содержит определенный элемент.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, есть ли строка Tombool hasTom = people.Contains("Tom");     // trueConsole.WriteLine(hasTom);// проверяем, есть ли строка Mikebool hasMike = people.Contains("Mike");     // falseConsole.WriteLine(hasMike);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Стоит отметить, что для сравнения объектов применяется реализация метода Equals. Соответственно если мы работаем с объектами своих типов, то мы можем реализовать данный метод:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name">Person<span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Sam"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> tom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> mike <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Mike"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// проверяем, есть ли Tombool hasTom = people.Contains(tom);     // trueConsole.WriteLine(hasTom);// проверяем, есть ли строка Mikebool hasMike = people.Contains(mike);     // falseConsole.WriteLine(hasMike);class Person{    public string Name { get;}    public Person(string name) =&gt; Name = name;    public override bool Equals(object? obj)    {        if (obj is Person person) return Name == person.Name;        return false;    }    public override int GetHashCode() =&gt; Name.GetHashCode();}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Но стоит отметить, что Contains не всегда может вернуть ожидаемые данные. Например:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"tom"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"bOb"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, есть ли строка Tombool hasTom = people.Contains("Tom");     // falseConsole.WriteLine(hasTom);// проверяем, есть ли строка Bobbool hasMike = people.Contains("Bob");     // falseConsole.WriteLine(hasMike);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>В данном случае в массиве нет строки “Tom”, а есть строка “tom”. Поэтому вызов&nbsp;<code>people.Contains("Tom")</code>&nbsp;возвратит false. Но подобное поведение не всегда может быть желательным. И в этом случае мы можем задать логику сравнения с помощью реализации интерфейса IComparer и затем передать ее в качестве второго параметра в метод Contains:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>CodeAnalysis</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"tom"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"bOb"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, есть ли строка Tombool hasTom = people.Contains("Tom", new CustomStringComparer());     // trueConsole.WriteLine(hasTom);// проверяем, есть ли строка Bobbool hasMike = people.Contains("Bob", new CustomStringComparer());     // trueConsole.WriteLine(hasMike);class CustomStringComparer : IEqualityComparer&lt;string&gt;{    public bool Equals(string? x, string? y)    {        if (x is null || y is null) return false;        return x.ToLower() == y.ToLower();    }    public int GetHashCode(string obj) =&gt; obj.ToLower().GetHashCode();}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Интерфейс IEqualityComparer типизируется типом сравниваемых данных (в данном случае типом String). Для реализации этого интерфейса необходимо определить методы Equals и GetHashCode. В методе Equals сравниваем строки в нижнем регистре, а в методе GetHashCode возвращаем возвращаем хеш-код строки в нижнем регистре.</p></div></div></div><div class="heading-wrapper"><h3 data-heading="First/FirstOrdefault" class="heading" id="First/FirstOrdefault"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>First/FirstOrdefault</h3><div class="heading-children"><div><p>Метод&nbsp;First()&nbsp;возвращает первый элемент последовательности:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// проверяем, есть ли строка Tomvar first = people.First();  // TomConsole.WriteLine(first);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Также в метод First можно передать метод, который представляет условие. В этом случае метод возвращает первый элемент, который соответствует условию:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// первая строка, длина которой равна 4 символамvar firstWith4Chars = people.First(s=&gt; s.Length == 4);  // KateConsole.WriteLine(firstWith4Chars);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь выбираем первый элемент, длина которого - 4 символа.</p></div><div><p>Стоит учитывать, что если коллекция пуста или в коллекции нет элементов, который соответствуют условию, то будет сгенерировано исключение.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// первая строка, длина которой равна 5 символамvar firstWith5Chars = people.First(s =&gt; s.Length == 5);  // ! исключениеConsole.WriteLine(firstWith5Chars);var first = new string[] {}.First();  // ! исключениеConsole.WriteLine(first);</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="FirstOrdefault" class="heading" id="FirstOrdefault"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>FirstOrdefault</h3><div class="heading-children"><div><p>Метод&nbsp;<code>FirstOrDefault()</code>&nbsp;также возвращает первый элемент и также может принимать условие, только если коллекция пуста или в коллекции не окажется элементов, которые соответствуют условию, то метод возвращает значение по умолчанию:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// первый элементvar first = people.FirstOrDefault();  // TomConsole.WriteLine(first);// первая строка, длина которой равна 4 символамvar firstWith4Chars = people.FirstOrDefault(s =&gt; s.Length == 4);  // KateConsole.WriteLine(firstWith4Chars);// первый элемент из пустой коллекцииvar firstOrDefault = new string[] {}.FirstOrDefault();Console.WriteLine(firstOrDefault);  // null</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Стоит учитывать, что для коллекций ссылочных типов FirstOrDefault возвращает значение типа T? (в примере выше - string?), то есть значение, которое может быть равно null, а значение по умолчанию - null. Для коллекций числовых типов возвращается непосредственно значение типа T, а значение по умолчанию - 0.</p></div><div><p>Но мы можем настроить значение по умолчанию, передав его в качестве одного из аргументов:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> firstWith5Chars <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>s <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"Undefined"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>firstWith5Chars<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Undefined// первый элемент из пустой коллекции строкstring? firstOrDefault = new string[] {}.FirstOrDefault("hello"); // hello - значение по умолчаниюConsole.WriteLine(firstOrDefault);  // hello// первый элемент из пустой коллекции intint firstNumber = new int[] {}.FirstOrDefault(100); // 100 - значение по умолчаниюConsole.WriteLine(firstNumber); // 100</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h3 data-heading="Last и LastOrDefault" class="heading" id="Last_и_LastOrDefault"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Last и LastOrDefault</h3><div class="heading-children"><div><p>Метод&nbsp;Last()&nbsp;аналогичен по работе методу First, только возвращает последний элемент. Если коллекция не содержит элемент, который соответствуют условию, или вообще пуста, то метод генерирует исключение.</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span></span> last <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Samstring lastWith4Chars = people.Last(s =&gt; s.Length == 4);Console.WriteLine(lastWith4Chars); // Mike</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод&nbsp;<code>LastOrDefault()</code>&nbsp;возвращает последний элемент или значение по умолчанию, если коллекция не содержит элемент, который соответствуют условию, или вообще пуста:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> last <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">LastOrDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Samstring? lastWith4Chars = people.LastOrDefault(s =&gt; s.Length == 4);Console.WriteLine(lastWith4Chars); // Mikestring? lastWith5Chars = people.LastOrDefault(s =&gt; s.Length == 5);Console.WriteLine(lastWith5Chars); // nullstring? lastWith5CharsOrDefault = people.LastOrDefault(s =&gt; s.Length == 5, "Undefined");Console.WriteLine(lastWith5CharsOrDefault); // Undefined// первый элемент из пустой коллекции строкstring? lastOrDefault = new string[] {}.LastOrDefault("hello");Console.WriteLine(lastOrDefault);  // hello</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Отложенное и немедленное выполнение LINQ" class="heading" id="Отложенное_и_немедленное_выполнение_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Отложенное и немедленное выполнение LINQ</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Отложенное и немедленное выполнение LINQ" src="Отложенное и немедленное выполнение LINQ" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Отложенное и немедленное выполнение LINQ</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 3298px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Отложенное и немедленное выполнение LINQ</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Есть два способа выполнения запроса LINQ:&nbsp;отложенное&nbsp;(deferred) и&nbsp;немедленное&nbsp;(immediate) выполнение.</p></div><div><p>При отложенном выполнении LINQ-выражение не выполняется, пока не будет произведена итерация или перебор по выборке, например, в цикле foreach. Обычно подобные операции возвращают объект&nbsp;<code>IEnumerable&lt;T&gt;</code>&nbsp;или&nbsp;<code>IOrderedEnumerable&lt;T&gt;</code>. Полный список отложенных операций LINQ:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>AsEnumerable</li>
<li data-line="1"><div class="list-bullet"></div>Cast</li>
<li data-line="2"><div class="list-bullet"></div>Concat</li>
<li data-line="3"><div class="list-bullet"></div>DefaultIfEmpty</li>
<li data-line="4"><div class="list-bullet"></div>Distinct</li>
<li data-line="5"><div class="list-bullet"></div>Except</li>
<li data-line="6"><div class="list-bullet"></div>GroupBy</li>
<li data-line="7"><div class="list-bullet"></div>GroupJoin</li>
<li data-line="8"><div class="list-bullet"></div>Intersect</li>
<li data-line="9"><div class="list-bullet"></div>Join</li>
<li data-line="10"><div class="list-bullet"></div>OfType</li>
<li data-line="11"><div class="list-bullet"></div>OrderBy</li>
<li data-line="12"><div class="list-bullet"></div>OrderByDescending</li>
<li data-line="13"><div class="list-bullet"></div>Range</li>
<li data-line="14"><div class="list-bullet"></div>Repeat</li>
<li data-line="15"><div class="list-bullet"></div>Reverse</li>
<li data-line="16"><div class="list-bullet"></div>Select</li>
<li data-line="17"><div class="list-bullet"></div>SelectMany</li>
<li data-line="18"><div class="list-bullet"></div>Skip</li>
<li data-line="19"><div class="list-bullet"></div>SkipWhile</li>
<li data-line="20"><div class="list-bullet"></div>Take</li>
<li data-line="21"><div class="list-bullet"></div>TakeWhile</li>
<li data-line="22"><div class="list-bullet"></div>ThenBy</li>
<li data-line="23"><div class="list-bullet"></div>ThenByDescending</li>
<li data-line="24"><div class="list-bullet"></div>Union</li>
<li data-line="25"><div class="list-bullet"></div>Where</li>
</ul></div><div><p>Рассмотрим отложенное выполнение:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// выполнение LINQ-запросаforeach (string s in selectedPeople)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>То есть фактическое выполнение запроса происходит не в строке определения:&nbsp;<code>var selectedPeople = people.Where...</code>, а при переборе в цикле foreach.</p></div><div><p>Фактически LINQ-запрос разбивается на три этапа:</p></div><div><ol>
<li data-line="0">Получение источника данных</li>
<li data-line="1">Создание запроса</li>
<li data-line="2">Выполнение запроса и получение его результатов</li>
</ol></div><div><p>Как это происходит в нашем случае:</p></div><div><ol>
<li data-line="0">Получение источника данных - определение массива teams:</li>
</ol></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><ol>
<li data-line="0">Создание запроса - определение переменной selectedTeams:</li>
</ol></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><ol>
<li data-line="0">Выполнение запроса и получение его результатов:</li>
</ol></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> s <span class="token keyword">in</span> selectedPeople<span class="token punctuation">)</span>    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>После определения запроса он может выполняться множество раз. И до выполнения запроса источник данных может изменяться. Чтобы более наглядно увидеть это, мы можем изменить какой-либо элемент до перебора выборки:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>people<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Mike"</span><span class="token punctuation">;</span><span class="token comment">// выполнение LINQ-запросаforeach (string s in selectedPeople)    Console.WriteLine(s);</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Теперь выборка будет содержать два элемента, а не три, так как последний элемент после изменения не будет соответствовать условию.</p></div><div><p>Важно понимать, что переменная запроса сама по себе не выполняет никаких действий и не возвращает никаких данных. Она только хранит набор команд, которые необходимы для получения результатов. То есть выполнение запроса после его создания откладывается. Само получение результатов производится при переборе в цикле foreach.</p></div><div class="heading-wrapper"><h3 data-heading="Немедленное выполнение запроса" class="heading" id="Немедленное_выполнение_запроса"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Немедленное выполнение запроса</h3><div class="heading-children"><div><p>С помощью ряда методов мы можем применить немедленное выполнение запроса. Это методы, которые возвращают одно атомарное значение или один элемент или данные типов Array, List и Dictionary. Полный список подобных операций в LINQ:</p></div><div><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>Aggregate</li>
<li data-line="1"><div class="list-bullet"></div>All</li>
<li data-line="2"><div class="list-bullet"></div>Any</li>
<li data-line="3"><div class="list-bullet"></div>Average</li>
<li data-line="4"><div class="list-bullet"></div>Contains</li>
<li data-line="5"><div class="list-bullet"></div>Count</li>
<li data-line="6"><div class="list-bullet"></div>ElementAt</li>
<li data-line="7"><div class="list-bullet"></div>ElementAtOrDefault</li>
<li data-line="8"><div class="list-bullet"></div>Empty</li>
<li data-line="9"><div class="list-bullet"></div>First</li>
<li data-line="10"><div class="list-bullet"></div>FirstOrDefault</li>
<li data-line="11"><div class="list-bullet"></div>Last</li>
<li data-line="12"><div class="list-bullet"></div>LastOrDefault</li>
<li data-line="13"><div class="list-bullet"></div>LongCount</li>
<li data-line="14"><div class="list-bullet"></div>Max</li>
<li data-line="15"><div class="list-bullet"></div>Min</li>
<li data-line="16"><div class="list-bullet"></div>SequenceEqual</li>
<li data-line="17"><div class="list-bullet"></div>Single</li>
<li data-line="18"><div class="list-bullet"></div>SingleOrDefault</li>
<li data-line="19"><div class="list-bullet"></div>Sum</li>
<li data-line="20"><div class="list-bullet"></div>ToArray</li>
<li data-line="21"><div class="list-bullet"></div>ToDictionary</li>
<li data-line="22"><div class="list-bullet"></div>ToList</li>
<li data-line="23"><div class="list-bullet"></div>ToLookup</li>
</ul></div><div><p>Рассмотрим пример с методом&nbsp;<code>Count()</code>, который возвращает число элементов последовательности:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// определение и выполнение LINQ-запросаvar count = people.Where(s=&gt;s.Length == 3).OrderBy(s=&gt;s).Count();Console.WriteLine(count);   // 3 - до изменения коллекцииpeople[2] = "Mike";Console.WriteLine(count);   // 3 - после изменения коллекции</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Результатом метода Count будет объект&nbsp;<code>int</code>, поэтому сработает немедленное выполнение.</p></div><div><p>Сначала создается запрос:&nbsp;<code>people.Where(s=&gt;s.Length == 3).OrderBy(s=&gt;s)</code>. Далее к нему применяется метод&nbsp;<code>Count()</code>, который выполняет запрос, неявно выполняет перебор по последовательности элементов, генерируемой этим запросом, и возвращает число элементов в этой последовательности.</p></div><div><p>Также мы можем изменить код таким образом, чтобы метод&nbsp;<code>Count()</code>&nbsp;учитывал изменения и выполнялся отдельно от определения запроса:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// определение LINQ-запроса</span>
<span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// выполнение запроса</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>selectedPeople<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token comment">// 3 - до изменения коллекции</span>
people<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Mike"</span><span class="token punctuation">;</span>
<span class="token comment">// выполнение запроса</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>selectedPeople<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token comment">// 2 - после изменения коллекции</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Также для немедленного выполнения LINQ-запроса и кэширования его результатов мы можем применять методы преобразования&nbsp;<code>ToArray&lt;T&gt;()</code>,&nbsp;<code>ToList&lt;T&gt;()</code>,&nbsp;<code>ToDictionary()</code>&nbsp;и т.д.. Эти методы получают результат запроса в виде объектов Array, List и Dictionary соответственно. Например:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// определение и выполнение LINQ-запроса</span>
<span class="token class-name"><span class="token keyword">var</span></span> selectedPeople <span class="token operator">=</span> people
	<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>s<span class="token operator">=&gt;</span>s<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// изменение массива никак не затронет список selectedPeoplepeople[2] = "Mike";</span>
	<span class="token comment">// выполнение запроса</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> s <span class="token keyword">in</span> selectedPeople<span class="token punctuation">)</span>    
	Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div></div></div><div class="heading-wrapper"><h3 data-heading="Делегаты в запросах LINQ" class="heading" id="Делегаты_в_запросах_LINQ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Делегаты в запросах LINQ</h3><div class="heading-children"><div><span style="display: block; margin-block-start: var(--p-spacing); margin-block-end: var(--p-spacing);"><span alt="Делегаты в запросах LINQ" src="Делегаты в запросах LINQ" class="internal-embed markdown-embed inline-embed is-loaded"><div class="embed-title markdown-embed-title">Делегаты в запросах LINQ</div><div class="markdown-embed-content node-insert-event"><div class="markdown-preview-view markdown-rendered node-insert-event show-indentation-guide allow-fold-headings allow-fold-lists"><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: 0px; min-height: 654px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"><div class="inline-title" contenteditable="true" spellcheck="true" autocapitalize="on" tabindex="-1" enterkeyhint="done">Делегаты в запросах LINQ</div></div><div><pre class="frontmatter language-yaml" tabindex="0" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">Parent</span><span class="token punctuation">:</span> <span class="token string">"[[LINQ by Metanit]]"</span></code><button class="copy-code-button">Copy</button></pre></div><div><p>Если мы обратимся к определению многих методов расширений LINQ, то увидим, что в качестве параметра многие из них принимают делегаты например,&nbsp;Func&lt;TSource, bool&gt;, например, определение метода Where:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">Where</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">&gt;</span></span> source<span class="token punctuation">,</span> <span class="token class-name">Func<span class="token punctuation">&lt;</span>TSource<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> predicate<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Хотя, как правило, в качестве делегата в подобные методы удобно передавать лямбда-выражения. Но тем не менее мы также можем передать полноценные методы. Например:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> people <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Kate"</span><span class="token punctuation">,</span> <span class="token string">"Tim"</span><span class="token punctuation">,</span> <span class="token string">"Mike"</span><span class="token punctuation">,</span> <span class="token string">"Sam"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> people<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>LenghtIs3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> person <span class="token keyword">in</span> result<span class="token punctuation">)</span>
	Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">LenghtIs3</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> name<span class="token punctuation">.</span>Length <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Здесь метод LenghtIs3 проверяет, равна ли длина строки 3 символам. Так как в данном случае набор элементов, к которому применяется метод Where, содержит объекты string, то в метод в качестве параметра передается объект этого типа. Возвращаемый тип должен представлять тип&nbsp;<code>bool</code>: если true, то объект string соответствует условию и попадает в выходную коллекцию.</p></div><div><p>Рассмотрим другой пример. Пусть метод&nbsp;<code>Select()</code>&nbsp;применяется к коллекции целых чисел и преобразует каждое число в его квадрат:</p></div><div><pre class="language-cs" tabindex="0"><code class="language-cs is-loaded"><span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>Square<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token keyword">in</span> result<span class="token punctuation">)</span>    
	Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Square</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> n<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Метод Select в качестве параметра принимает тип&nbsp;<code>Func&lt;TSource, TResult&gt; selector</code>. Так как у нас набор объектов&nbsp;<code>int</code>, то входным параметром делегата также будет объект типа int. В качестве типа выходного параметра выберем int, так как здесь квадрат числа - это целочисленное значение.</p></div></div></div></div><div class="markdown-embed-content node-insert-event" style="display: none;"></div><div class="markdown-embed-link" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div></span></span></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#LINQ by Metanit"><div class="tree-item-contents heading-link" heading-name="LINQ by Metanit"><span class="tree-item-title">LINQ by Metanit</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Основы_LINQ"><div class="tree-item-contents heading-link" heading-name="Основы LINQ"><span class="tree-item-title">Основы LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Операторы_запросов_LINQ"><div class="tree-item-contents heading-link" heading-name="Операторы запросов LINQ"><span class="tree-item-title">Операторы запросов LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Методы_расширения_LINQ"><div class="tree-item-contents heading-link" heading-name="Методы расширения LINQ"><span class="tree-item-title">Методы расширения LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Список_используемых_методов_расширения_LINQ"><div class="tree-item-contents heading-link" heading-name="Список используемых методов расширения LINQ"><span class="tree-item-title">Список используемых методов расширения LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Проекция_данных"><div class="tree-item-contents heading-link" heading-name="Проекция данных"><span class="tree-item-title">Проекция данных</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Переменые_в_запросах_и_оператор_let"><div class="tree-item-contents heading-link" heading-name="Переменые в запросах и оператор let"><span class="tree-item-title">Переменые в запросах и оператор let</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Выборка_из_нескольких_источников"><div class="tree-item-contents heading-link" heading-name="Выборка из нескольких источников"><span class="tree-item-title">Выборка из нескольких источников</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#SelectMany_и_сведение_объектов"><div class="tree-item-contents heading-link" heading-name="SelectMany и сведение объектов"><span class="tree-item-title">SelectMany и сведение объектов</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Фильтрация_коллекции"><div class="tree-item-contents heading-link" heading-name="Фильтрация коллекции"><span class="tree-item-title">Фильтрация коллекции</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Выборка_сложных_объектов"><div class="tree-item-contents heading-link" heading-name="Выборка сложных объектов"><span class="tree-item-title">Выборка сложных объектов</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Сложные_фильтры"><div class="tree-item-contents heading-link" heading-name="Сложные фильтры"><span class="tree-item-title">Сложные фильтры</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Фильтрация_по_типу_данных"><div class="tree-item-contents heading-link" heading-name="Фильтрация по типу данных"><span class="tree-item-title">Фильтрация по типу данных</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Методы_Skip_и_Take"><div class="tree-item-contents heading-link" heading-name="Методы Skip и Take"><span class="tree-item-title">Методы Skip и Take</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Skip"><div class="tree-item-contents heading-link" heading-name="Skip"><span class="tree-item-title">Skip</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#SkipWhile"><div class="tree-item-contents heading-link" heading-name="SkipWhile"><span class="tree-item-title">SkipWhile</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Take"><div class="tree-item-contents heading-link" heading-name="Take"><span class="tree-item-title">Take</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#TakeWhile"><div class="tree-item-contents heading-link" heading-name="TakeWhile"><span class="tree-item-title">TakeWhile</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Постраничный_вывод"><div class="tree-item-contents heading-link" heading-name="Постраничный вывод"><span class="tree-item-title">Постраничный вывод</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Сортировка"><div class="tree-item-contents heading-link" heading-name="Сортировка"><span class="tree-item-title">Сортировка</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Оператор_orderby_и_метод_OrderBy"><div class="tree-item-contents heading-link" heading-name="Оператор orderby и метод OrderBy"><span class="tree-item-title">Оператор orderby и метод OrderBy</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Сортировка_сложных_объектов"><div class="tree-item-contents heading-link" heading-name="Сортировка сложных объектов"><span class="tree-item-title">Сортировка сложных объектов</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Сортировка_по_возрастанию_и_убыванию"><div class="tree-item-contents heading-link" heading-name="Сортировка по возрастанию и убыванию"><span class="tree-item-title">Сортировка по возрастанию и убыванию</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Множественные_критерии_сортировки"><div class="tree-item-contents heading-link" heading-name="Множественные критерии сортировки"><span class="tree-item-title">Множественные критерии сортировки</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Переопределение_критерия_сортировки"><div class="tree-item-contents heading-link" heading-name="Переопределение критерия сортировки"><span class="tree-item-title">Переопределение критерия сортировки</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Объединение,_пересечение_и_разность_коллекций"><div class="tree-item-contents heading-link" heading-name="Объединение, пересечение и разность коллекций"><span class="tree-item-title">Объединение, пересечение и разность коллекций</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Разность_последовательностей"><div class="tree-item-contents heading-link" heading-name="Разность последовательностей"><span class="tree-item-title">Разность последовательностей</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Пересечение_последовательностей"><div class="tree-item-contents heading-link" heading-name="Пересечение последовательностей"><span class="tree-item-title">Пересечение последовательностей</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Удаление_дубликатов"><div class="tree-item-contents heading-link" heading-name="Удаление дубликатов"><span class="tree-item-title">Удаление дубликатов</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Объединение_последовательностей"><div class="tree-item-contents heading-link" heading-name="Объединение последовательностей"><span class="tree-item-title">Объединение последовательностей</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Работа_со_сложными_объектами"><div class="tree-item-contents heading-link" heading-name="Работа со сложными объектами"><span class="tree-item-title">Работа со сложными объектами</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Comments:"><div class="tree-item-contents heading-link" heading-name="Comments:"><span class="tree-item-title">Comments:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Віталік_Бречко:"><div class="tree-item-contents heading-link" heading-name="Віталік Бречко:"><span class="tree-item-title">Віталік Бречко:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Григорий:"><div class="tree-item-contents heading-link" heading-name="Григорий:"><span class="tree-item-title">Григорий:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Агрегатные_операции"><div class="tree-item-contents heading-link" heading-name="Агрегатные операции"><span class="tree-item-title">Агрегатные операции</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Метод_Aggregate"><div class="tree-item-contents heading-link" heading-name="Метод Aggregate"><span class="tree-item-title">Метод Aggregate</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Получение_размера_выборки._Метод_Count"><div class="tree-item-contents heading-link" heading-name="Получение размера выборки. Метод Count"><span class="tree-item-title">Получение размера выборки. Метод Count</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Получение_суммы"><div class="tree-item-contents heading-link" heading-name="Получение суммы"><span class="tree-item-title">Получение суммы</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Максимальное,_минимальное_и_среднее_значения"><div class="tree-item-contents heading-link" heading-name="Максимальное, минимальное и среднее значения"><span class="tree-item-title">Максимальное, минимальное и среднее значения</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Группировка"><div class="tree-item-contents heading-link" heading-name="Группировка"><span class="tree-item-title">Группировка</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Оператор_group_by"><div class="tree-item-contents heading-link" heading-name="Оператор group by"><span class="tree-item-title">Оператор group by</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#GroupBy"><div class="tree-item-contents heading-link" heading-name="GroupBy"><span class="tree-item-title">GroupBy</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Создание_нового_объекта_при_группировке"><div class="tree-item-contents heading-link" heading-name="Создание нового объекта при группировке"><span class="tree-item-title">Создание нового объекта при группировке</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Вложенные_запросы"><div class="tree-item-contents heading-link" heading-name="Вложенные запросы"><span class="tree-item-title">Вложенные запросы</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Соединение_коллекций"><div class="tree-item-contents heading-link" heading-name="Соединение коллекций"><span class="tree-item-title">Соединение коллекций</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Оператор_join"><div class="tree-item-contents heading-link" heading-name="Оператор join"><span class="tree-item-title">Оператор join</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Метод_Join"><div class="tree-item-contents heading-link" heading-name="Метод Join"><span class="tree-item-title">Метод Join</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#GroupJoin"><div class="tree-item-contents heading-link" heading-name="GroupJoin"><span class="tree-item-title">GroupJoin</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Метод_Zip"><div class="tree-item-contents heading-link" heading-name="Метод Zip"><span class="tree-item-title">Метод Zip</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Проверка_наличия_и_получение_элементов"><div class="tree-item-contents heading-link" heading-name="Проверка наличия и получение элементов"><span class="tree-item-title">Проверка наличия и получение элементов</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#All"><div class="tree-item-contents heading-link" heading-name="All"><span class="tree-item-title">All</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Any"><div class="tree-item-contents heading-link" heading-name="Any"><span class="tree-item-title">Any</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Contains"><div class="tree-item-contents heading-link" heading-name="Contains"><span class="tree-item-title">Contains</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#First/FirstOrdefault"><div class="tree-item-contents heading-link" heading-name="First/FirstOrdefault"><span class="tree-item-title">First/FirstOrdefault</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#FirstOrdefault"><div class="tree-item-contents heading-link" heading-name="FirstOrdefault"><span class="tree-item-title">FirstOrdefault</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Last_и_LastOrDefault"><div class="tree-item-contents heading-link" heading-name="Last и LastOrDefault"><span class="tree-item-title">Last и LastOrDefault</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Отложенное_и_немедленное_выполнение_LINQ"><div class="tree-item-contents heading-link" heading-name="Отложенное и немедленное выполнение LINQ"><span class="tree-item-title">Отложенное и немедленное выполнение LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="9"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Немедленное_выполнение_запроса"><div class="tree-item-contents heading-link" heading-name="Немедленное выполнение запроса"><span class="tree-item-title">Немедленное выполнение запроса</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="04.-literature-notes/linq-by-metanit/linq-by-metanit.html#Делегаты_в_запросах_LINQ"><div class="tree-item-contents heading-link" heading-name="Делегаты в запросах LINQ"><span class="tree-item-title">Делегаты в запросах LINQ</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>